<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Periodic_4_hyperbolic_triangulation_2/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.14 - 2D Periodic Hyperbolic Triangulations: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
<link href="customstyle.css" rel="stylesheet" type="text/css" />
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.14 - 2D Periodic Hyperbolic Triangulations
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_2D_Periodic_Hyperbolic_Triangulations"></a><a class="anchor" id="chapterP4HTriangulation2"></a>  </p><div id="autotoc" class="toc"></div>  <dl class="section author"><dt>Author</dt><dd>Iordan Iordanov &amp; Monique Teillaud</dd></dl>
<center> <div class="image">
<img src="new-triangulation-350px.png" style="max-width:50%; width=50%;" />
</div>
 </center><p>This package allows to compute Delaunay triangulations of the Bolza surface, which is the most symmetric surface of genus 2. The Bolza surface is a hyperbolic closed compact orientable surface.</p>
<p>A triangulation is defined as a <em>simplicial complex</em>, i.e.: </p><ul>
<li>
it contains all incident \( j\)-simplices ( \( j&lt;k\)) of any \( k\)-simplex, and </li>
<li>
two \( k\)-simplices either do not intersect or share a common \( j\)-face, \( j&lt;k\). </li>
</ul>
<p>The simplices of dimension 0, 1, and 2 are called <em>vertex</em>, <em>edge</em>, and <em>face</em>, respectively.</p>
<p>A triangulation of the Bolza surface can be seen as a periodic triangulation of the hyperbolic plane.</p>
<h1><a class="anchor" id="P4HT2_thespace"></a>
The Bolza surface</h1>
<p>Let \(\mathbb{H}^2\) denote the hyperbolic plane, represented in the Poincaré disk model. Consider the regular hyperbolic octagon \( \mathcal D_O \) centered at the origin, with all angles equal to \( \pi/4\) that is shown in <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 43.1</a> - Left. Note that \(\mathcal D_O\) is unique up to rotation, and cannot be scaled, since this operation would change its angles. Consider the four hyperbolic translations \( a,b,c,d\) with their respective inverses \(\overline{a}, \overline{b}, \overline{c}, \overline{d}\) that identify the opposite sides of \( \mathcal D_O \). The axes of these translations are diameters of the Poincaré disk. See <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 43.1</a> - Left. The four translations \(a, b, c, d\) generate a (non-commutative) discrete group of orientation-preserving isometries, with finite presentation </p><p class="formulaDsp">
\[ \mathcal{G} = \left&lt; a,b,c,d \; \bigg| \; abcd\overline{a}\overline{b}\overline{c}\overline{d} \right&gt;. \]
</p>
<p> Note that equivalent translations of the group \(\mathcal G\) can be reduced to a unique minimal representative.</p>
<p>The group \(\mathcal G\) is acting on \(\mathbb H^2\); two points \(p\) and \(q\) in \(\mathbb H^2\) are in the same orbit under the action of \(\mathcal G\) if there exists an element \(g \in \mathcal G\) such that \(g(p) = q\). See <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 43.1</a> - Center. The Bolza surface \(\mathcal{M}\) is defined as the quotient of \(\mathbb H^2\) under the action of \(\mathcal G\), named the fundamental group of \(\mathcal M\): </p><p class="formulaDsp">
\[ \mathcal{M} = \mathbb H^2 / \mathcal{G} \]
</p>
<p> \(\pi\) denotes the natural projection map from \(\mathbb H^2\) onto \(\mathcal M\).</p>
<p><a class="anchor" id="fig__P4HTriangulationOctagonId"></a></p><center> <div class="image">
<object type="image/svg+xml" data="octagon_identification.svg" style="max-width:25%; width=25%; display: inline-block;"></object>
</div>
 <div class="image">
<img src="periodicity.png" style="max-width:25%; width=25%; display: inline-block;" />
</div>
 <div class="image">
<object type="image/svg+xml" data="original_domain.svg" style="max-width:25%; width=25%; display: inline-block;"></object>
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 43.1</a> <b>Left:</b> The hyperbolic translations \(a,b,c,d\) and their inverses identify opposite sides of the octagon \(\mathcal D_O\). <b>Center:</b> Illustration of periodicity in the hyperbolic plane. The figure shows a few periodic copies of the points in the central octagon. <b>Right:</b> The half-open octagon \(\mathcal D\) is an original domain for \(\mathcal{M}\). Note that only one vertex of the octagon is included in the original domain.  </div>  <br />

<p>By definition, all points of \(\mathbb H^2\) that belong to the same orbit under the action of \(\mathcal G\) project by \(\pi\) onto the same point of the surface \(\mathcal M\). The half-open octagon \(\mathcal D\) shown in <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 43.1</a> - Right contains exactly one <em>representative</em> of each point of \(\mathcal{M}\); \(\mathcal D\) is called the <em>original domain</em> of \(\mathcal{M}\). A point outside \(\mathcal D\) is the image of a point in \(\mathcal D\) under the action of a uniquely defined translation in the group \(\mathcal{G}\).</p>
<p><a class="el" href="index.html#fig__P4HTDoubleTorusConstruction">Figure 43.2</a> illustrates how a genus-2 surface can be obtained by identifying opposite sides of \(\mathcal D\) under the action of \(\mathcal G\).</p>
<p><a class="anchor" id="fig__P4HTDoubleTorusConstruction"></a></p><center> <div class="image">
<object type="image/svg+xml" data="dt-construction.svg" style="max-width:60%; width=60%; display: inline-block;"></object>
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P4HTDoubleTorusConstruction">Figure 43.2</a> Topological construction of a genus-2 surface from the original domain \(\mathcal D\) of the Bolza surface. Each open side is paired with the opposite closed side. Note that all vertices of the octagon project to the same point on the surface, which is represented uniquely by the only vertex of \(\mathcal D\).  </div>  <br />

<h1><a class="anchor" id="P4HT2_representation"></a>
Representation</h1>
<p>When there is no risk of confusion, the same notation will be used for a point on the surface \(\mathcal M\) and its representative in \(\mathcal D\). Similarly, \(\mathcal{P}\) denotes both a set of points on the surface and the set of their representatives in \(\mathcal D\).</p>
<p>The Delaunay triangulation of \(\mathcal{M}\) defined by a point set \(\mathcal{P}\) is defined as the projection by \(\pi\) of the Delaunay triangulation in the plane \(\mathbb H^2\) of the (infinite) set of points \(\mathcal{G P}\) onto \(\mathcal{M}\), under some validity conditions that will be detailed in Section <a class="el" href="index.html#P4HT2_validity">Validity</a>.</p>
<p>We require that all input points lie inside \(\mathcal D\). As for orbits of points, all faces of the Delaunay triangulation of \(\mathcal{G P}\) that are in the same orbit under the action of \(\mathcal{G}\) project by \(\pi\) onto the same face on the surface \(\mathcal{M}\); the data structure stores a unique <em>canonical</em> representative of each orbit, which has at least one vertex in \(\mathcal D\). Some canonical faces have vertices both inside and outside \(\mathcal D\). Such faces can be uniquely specified by three pairs of points in \(\mathcal D\) and (reduced) translations of \(\mathcal{G}\); points in the original domain are paired with the identity translation \(\mathbb 1\). The underlying combinatorial triangulation is a <a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/TDS_2.tag:../TDS_2/" href="../TDS_2/group__PkgTDS2.html">2D Triangulation Data Structure Reference</a>, enriched in each face by the three translations that are paired with the point in each vertex. See <a class="el" href="index.html#fig__P4HTriangulationOrientationDS">Figure 43.3</a>.</p>
<p><a class="anchor" id="fig__P4HTriangulationOrientationDS"></a></p><center> <div class="image">
<object type="image/svg+xml" data="ds_cgal.svg" style="max-width:40%; width: 1000px;"></object>
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P4HTriangulationOrientationDS">Figure 43.3</a> Representation of a face \(f\) stored in the triangulation data structure. Each vertex \(v_i\) stores a point \(p_i\) paired with a translation \(\tau_i\).  </div>  <br />

<p>More precisely, the translations are elements of the subset \(\mathcal N\) of \(\mathcal G\) for which the image of \(\mathcal D_O\) has at least one vertex in common with \(\mathcal D_O\). These images of \(\mathcal D_O\) by translations in \(\mathcal N\) are shaded in <a class="el" href="index.html#fig__P4HTriangulationCanonicalRepExample">Figure 43.4</a>; we consider them to be ordered counterclockwise around \(\mathcal D_O\), arbitrarily starting with the one corresponding to translation \(abcd\). The canonical representative in \(\mathbb H^2\) of a face on \(\mathcal M\) is such that </p><ul>
<li>
either all vertices of the representative lie in \(\mathcal D\), or </li>
<li>
the representative has at least one vertex in \(\mathcal D\) and is as close as possible to \(abcd\) in the ordering defined above. </li>
</ul>
<p><a class="anchor" id="fig__P4HTriangulationCanonicalRepExample"></a></p><center> <div class="image">
<object type="image/svg+xml" data="periodic_face.svg" style="max-width:45%; width=45%; display: inline-block;"></object>
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P4HTriangulationCanonicalRepExample">Figure 43.4</a> Among the three faces in the orbit that have at least one vertex in \(\mathcal D\), the canonical representative is the green one: it is closest, in the counterclockwise order, to the region labeled \(abcd\). The translations \(\mathbb 1, a\), and \(\overline{b}\), corresponding to the points \(p, q\), and \(r\) are stored in the face in the data structure.  </div>  <br />

<h1><a class="anchor" id="P4HT2_validity"></a>
Validity</h1>
<p>Let us now give details on the validity condition mentioned above. A periodic hyperbolic triangulation is said to be <code>valid</code> if and only if </p><ol>
<li>
Its underlying combinatorial graph, the triangulation data structure, is <code>valid</code> (see the function <a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/TDS_2.tag:../TDS_2/" href="../TDS_2/classTriangulationDataStructure__2.html#addd3db2766b6edc86a042599f364a396">is_valid</a>() in the concept <a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/TDS_2.tag:../TDS_2/" href="../TDS_2/classTriangulationDataStructure__2.html">TriangulationDataStructure_2</a>) and each face of the triangulation is positively oriented. See <a class="el" href="index.html#fig__P4HTriangulationOrientationDS">Figure 43.3</a>.  </li>
<li>
It is a triangulation of a genus-2 surface; this condition is satisfied when the Euler relation \(V-E+F = -2\) is verified, where \(V, E, F\) are the number of vertices, edges and faces of the triangulation, respectively.  </li>
<li>
The combinatorial graph of the triangulation does not contain cycles of length 1 or 2; this condition is equivalent to requiring that the triangulation is a simplicial complex.  </li>
</ol>
<p>Some point sets do not define a valid triangulation of \(\mathcal M\). For instance, a single point does not define a valid triangulation of \(\mathcal M\), as the induced subdivision would not be a simplicial complex. Another example is shown in <a class="el" href="index.html#fig__P4HNonSimplicialExample">Figure 43.5</a>.</p>
<p><a class="anchor" id="fig__P4HNonSimplicialExample"></a></p><center> <div class="image">
<object type="image/svg+xml" data="non-triangulation.svg" style="max-width:45%; width=45%; display: inline-block;"></object>
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P4HNonSimplicialExample">Figure 43.5</a> The three points in the central octagon define a subdivision of the Bolza surface that is <b>not</b> a triangulation, since it is non-simplicial. A few cycles of length 2 are shown in color, leading to double edges on the surface. The pink edge between the two blue vertices corresponds to a loop (cycle of length 1) on the surface.  </div>  <br />

<p>We initialize a triangulation of \(\mathcal M\) with a predetermined set \(\mathcal Q\) of 14 points, called <em>dummy points</em>, which ensures that the projection by \(\pi\) of the Delaunay triangulation of \(\mathcal{G} (\mathcal{P}\cup\mathcal{Q})\) onto \(\mathcal M\) is a simplicial complex for any set of input points \(\mathcal{P}\) <a class="el" href="citelist.html#CITEREF_cgal:btv-dtosl-16">[1]</a>. See <a class="el" href="index.html#fig__P4HTriangulationDummyPoints">Figure 43.6</a>.</p>
<p><a class="anchor" id="fig__P4HTriangulationDummyPoints"></a></p><center> <div class="image">
<img src="dummy-points.png" style="max-width:35%; width=35%; display: inline-block;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P4HTriangulationDummyPoints">Figure 43.6</a> Delaunay triangulation of \(\mathcal M\) defined by the 14 dummy points. The set \(\mathcal Q\) of dummy points contains the origin, the vertex of \(\mathcal D\), the midpoints of the closed sides of \(\mathcal D\), and the hyperbolic midpoints of the segments between the origin and the vertices of the octagon.  </div>  <br />

<p>If sufficiently many well-distributed points are inserted, the dummy points become unnecessary, i.e., the triangulation remains a simplicial complex even if we remove them. If the set of input points is not sufficiently large, or if the points are not well-distributed on the surface, then the final triangulation will contain the dummy points necessary to guarantee that the triangulation is a simplicial complex.</p>
<h1><a class="anchor" id="P4HT2_design"></a>
Software Design</h1>
<p>The main class of this package is <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 allows the construction and handling of Dela...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code>, which implements Delaunay triangulations of the Bolza surface \(\mathcal M\). The prefix "Periodic_4" emphasizes that the triangulation in the universal covering \(\mathbb H^2\) is periodic in the four directions defined by the hyperbolic translations \( a,b,c\), and \(d\).</p>
<p>Delaunay triangulations have the <em>empty circle property</em>, that is, the circumscribing hyperbolic circle of each face does not contain any other vertex of the triangulation in its interior. Since hyperbolic circles coincide with Euclidean circles in the Poincaré disk model, the implementation uses Euclidean predicates to ensure the Delaunay property. Degenerate point sets (i.e., more than three co-circular points) are handled with symbolic perturbations <a class="el" href="citelist.html#CITEREF_cgal:dt-pvr3d-03">[2]</a>.</p>
<p>The implementation is fully dynamic, supporting both point insertion and vertex removal. However, a vertex can be removed only if the triangulation remains valid (as defined above).</p>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 allows the construction and handling of Dela...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code> provides high-level geometric functionality specific to Delaunay triangulations, such as point insertion and vertex removal, the side-of-circle test, finding the conflicting region of a given point, and dual functions. It inherits from a base class called <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__2.html" title="The class Periodic_4_hyperbolic_triangulation_2 offers base functionalities needed by Periodic_4_hype...">Periodic_4_hyperbolic_triangulation_2</a></code> that provides functionality common to triangulations in general, such as point location <a class="el" href="citelist.html#CITEREF_cgal:dpt-wt-02">[3]</a>, and access functions, but supports neither point insertion nor vertex removal.</p>
<p>Both classes <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__2.html" title="The class Periodic_4_hyperbolic_triangulation_2 offers base functionalities needed by Periodic_4_hype...">Periodic_4_hyperbolic_triangulation_2</a></code> and <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 allows the construction and handling of Dela...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code> require two template parameters that reflect the separation between the geometric and combinatorial structures of the triangulation:</p>
<ul>
<li>a <b>geometric traits</b> class, which provides all objects, predicates, and constructions necessary for the computation of Delaunay triangulations of the Bolza surface.For more details, see Section <a class="el" href="index.html#P4HT2_traits">The Geometric Traits Parameter</a>.</li>
<li>a <b>triangulation data structure</b> class, which encodes the combinatorial structure of the triangulation. See Section <a class="el" href="index.html#P4HT2_datastructure">The Triangulation Data Structure Parameter</a>.</li>
</ul>
<h2><a class="anchor" id="P4HT2_traits"></a>
The Geometric Traits Parameter</h2>
<p>The geometric traits class must fulfill the requirements described in the concept <code><a class="el" href="classPeriodic__4HyperbolicDelaunayTriangulationTraits__2.html">Periodic_4HyperbolicDelaunayTriangulationTraits_2</a></code>. It must provide all necessary objects, predicates, and constructions for the computation of Delaunay triangulations of the Bolza surface. Moreover, the traits class must represent hyperbolic translations of the group \(\mathcal G\) via the class <code><a class="el" href="classCGAL_1_1Hyperbolic__octagon__translation.html" title="The class Hyperbolic_octagon_translation defines an object to represent a hyperbolic translation of t...">Hyperbolic_octagon_translation</a></code>.</p>
<p>A model for the concept <code><a class="el" href="classPeriodic__4HyperbolicDelaunayTriangulationTraits__2.html">Periodic_4HyperbolicDelaunayTriangulationTraits_2</a></code> offered by this package is the class <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__traits__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_traits_2 is the default traits class for the c...">Periodic_4_hyperbolic_Delaunay_triangulation_traits_2</a></code>. The class requires one template parameter: </p><ul>
<li>
A <code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classKernel.html">Kernel</a></code> with a field number type <code>FT</code> that guarantees exact computations on algebraic numbers with nested square roots. The default value for this parameter is <code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Cartesian.html">CGAL::Cartesian</a>&lt;<a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Number_types.tag:../Number_types/" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a>&gt;</code>. </li>
</ul>
<h2><a class="anchor" id="P4HT2_datastructure"></a>
The Triangulation Data Structure Parameter</h2>
<p>The triangulation data structure class is the second template parameter of the periodic hyperbolic triangulation classes. It is a container for the faces and vertices and maintains incidence and adjacency relations. This parameter must meet the requirements described in the concept <code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/TDS_2.tag:../TDS_2/" href="../TDS_2/classTriangulationDataStructure__2.html">TriangulationDataStructure_2</a></code>, for which <span style="font-variant: small-caps;">CGAL</span> offers the model <code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/TDS_2.tag:../TDS_2/" href="../TDS_2/classCGAL_1_1Triangulation__data__structure__2.html">Triangulation_data_structure_2</a></code>. This model is itself parameterized by a vertex base class and a face base class, which gives the possibility to customize the vertices and faces used by the triangulation data structure. To represent periodic hyperbolic triangulations, the face base and vertex base classes must be models of the concepts <code><a class="el" href="classPeriodic__4HyperbolicTriangulationFaceBase__2.html" title=" &lt;div class=&quot;CGALModification&quot;&gt;  ">Periodic_4HyperbolicTriangulationFaceBase_2</a></code> and <code><a class="el" href="classPeriodic__4HyperbolicTriangulationVertexBase__2.html" title=" &lt;div class=&quot;CGALModification&quot;&gt;  ">Periodic_4HyperbolicTriangulationVertexBase_2</a></code>, respectively.</p>
<p>The default value for the triangulation data structure parameter in the class <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 allows the construction and handling of Dela...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code> is <code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/TDS_2.tag:../TDS_2/" href="../TDS_2/classCGAL_1_1Triangulation__data__structure__2.html">Triangulation_data_structure_2</a>&lt; <a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__face__base__2.html" title="The class Periodic_4_hyperbolic_triangulation_face_base_2 is the default model for the concept Period...">Periodic_4_hyperbolic_triangulation_face_base_2</a>&lt;Traits&gt;, <a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__vertex__base__2.html" title="The class Periodic_4_hyperbolic_triangulation_vertex_base_2 is the default model for the concept Peri...">Periodic_4_hyperbolic_triangulation_vertex_base_2</a>&lt;Traits&gt; &gt;</code>, where <code>Traits</code> is a model of <code><a class="el" href="classPeriodic__4HyperbolicDelaunayTriangulationTraits__2.html">Periodic_4HyperbolicDelaunayTriangulationTraits_2</a></code>.</p>
<h1><a class="anchor" id="P4HT2_examples"></a>
Example</h1>
<p>Most functionalities of periodic hyperbolic triangulations are similar to those of Euclidean 2D triangulations. We refer the reader to selected examples of the <a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Triangulation_2.tag:../Triangulation_2/" href="../Triangulation_2/index.html#Chapter_2D_Triangulations">2D Triangulation</a> package: </p><ul>
<li>
<a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Triangulation_2.tag:../Triangulation_2/" href="../Triangulation_2/index.html#Subsection_2D_Triangulations_Voronoi">Voronoi Diagram</a> </li>
<li>
<a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Triangulation_2.tag:../Triangulation_2/" href="../Triangulation_2/index.html#Triangulation_2AddingColors">Adding Colors</a> </li>
</ul>
<p>The example below shows the initialization of a periodic hyperbolic 2D Delaunay triangulation, the insertion of random points uniformly distributed in the unit disk for the Euclidean metric, and the properties of the triangulation after the insertion. It uses the default parameter of the <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 allows the construction and handling of Dela...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code> class for the triangulation data structure.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_4_hyperbolic_triangulation_2_2p4ht2_example_insertion_8cpp-example.html">Periodic_4_hyperbolic_triangulation_2/p4ht2_example_insertion.cpp</a> </p><div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Hyperbolic_octagon_translation.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_4_hyperbolic_Delaunay_triangulation_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_4_hyperbolic_Delaunay_triangulation_traits_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Number_types.tag:../Number_types/" href="../Number_types/CORE__Expr_8h.html">CGAL/CORE_Expr.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Cartesian.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/point_generators_2.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Number_types.tag:../Number_types/" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a>                                                              NT;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Cartesian.html">CGAL::Cartesian&lt;NT&gt;</a>                                                     <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/namespaceKernel.html">Kernel</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__traits__2.html">CGAL::Periodic_4_hyperbolic_Delaunay_triangulation_traits_2&lt;Kernel&gt;</a>     Traits;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html">CGAL::Periodic_4_hyperbolic_Delaunay_triangulation_2&lt;Traits&gt;</a>            Triangulation;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Triangulation.tag:../Triangulation/" href="../Triangulation/classCGAL_1_1Triangulation.html#a9cce545266f97305c03009e19a9574b8">Triangulation::Vertex_handle</a>                                            Vertex_handle;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Triangulation.tag:../Triangulation/" href="../Triangulation/classCGAL_1_1Triangulation.html#a1b422d984178df24b1802d9ea89a3731">Triangulation::Point</a>                                                    Point;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Triangulation.tag:../Triangulation/" href="../Triangulation/classCGAL_1_1Triangulation.html#ae83c49f5f2f90371376ee0faf469e760">Triangulation::size_type</a>                                                size_type;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/classCGAL_1_1Creator__uniform__2.html">CGAL::Creator_uniform_2&lt;NT,Point&gt;</a>                                       Creator;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">using</span> std::cout;</div><div class="line"><span class="keyword">using</span> std::endl;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {    </div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (argc &lt; 2) {</div><div class="line">        cout &lt;&lt; <span class="stringliteral">"usage: "</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">" [number_of_points_to_insert]"</span> &lt;&lt; endl;</div><div class="line">        <span class="keywordflow">return</span> -1;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> N = atoi(argv[1]);   </div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> N1 = N/2;</div><div class="line">    <span class="keywordtype">int</span> N2 = N - N1;</div><div class="line">    </div><div class="line">    <span class="comment">// Generate N random points uniformly distributed with respect to the Euclidean </span></div><div class="line">    <span class="comment">// metric in the disk with radius 0.85, which contains the fundamental domain. </span></div><div class="line">    <span class="comment">// Some of the points will be outside the octagon, so they will not be inserted.</span></div><div class="line">    std::vector&lt;Point&gt; pts;</div><div class="line">    CGAL::Random_points_in_disc_2&lt;Point,Creator&gt; g( 0.85 );</div><div class="line">    <a class="codeRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/group__STLAlgos.html#gadba21cc5c30a79519438dfe0f9264255">CGAL::cpp11::copy_n</a>( g, N1, std::back_inserter(pts) );</div><div class="line"></div><div class="line">    <span class="comment">// The triangulation is automatically initialized with the dummy points.</span></div><div class="line">    Triangulation tr;</div><div class="line"></div><div class="line">    <span class="comment">// Batch-insert new points in the triangulation. Note that by default, after</span></div><div class="line">    <span class="comment">// the insertion of a set of points, an attempt is made to remove all dummy points</span></div><div class="line">    <span class="comment">// from the triangulation. Note the third boolean parameter in the call of the </span></div><div class="line">    <span class="comment">// `insert()` function which suppresses the automatic removal of dummy points.</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Batch-inserting "</span> &lt;&lt; N1 &lt;&lt; <span class="stringliteral">" random points in the triangulation... "</span>; cout.flush();</div><div class="line">    size_type N_batch_inserted = tr.insert(pts.begin(), pts.end(), <span class="keyword">false</span>);</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"DONE! "</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// Insert new points in the triangulation one by one. When points are inserted </span></div><div class="line">    <span class="comment">// one by one, dummy points are not automatically removed.</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Single-inserting "</span> &lt;&lt; N2 &lt;&lt; <span class="stringliteral">" random points in the triangulation... "</span>; cout.flush();</div><div class="line">    <span class="keywordtype">int</span> N_single_inserted = 0;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N2; i++) {</div><div class="line">        Vertex_handle vh = tr.insert(*(++g));</div><div class="line">        <span class="keywordflow">if</span> (vh != Vertex_handle()) {</div><div class="line">            N_single_inserted++;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"DONE! "</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// Total number of inserted points.</span></div><div class="line">    <span class="keywordtype">int</span> N_inserted = N_batch_inserted + N_single_inserted;</div><div class="line"></div><div class="line">    <span class="comment">// Finally, we try to manually remove all dummy points from the triangulation.</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Cleaning dummy points from the triangulation... "</span>; cout.flush();</div><div class="line">    <span class="keywordtype">int</span> DP_remaining = tr.clean_dummy_points();</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"DONE! "</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// Make sure that the triangulation is valid.</span></div><div class="line">    CGAL_assertion(tr.is_valid());</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> NV = tr.number_of_vertices();</div><div class="line">    <span class="keywordtype">int</span> NF = tr.number_of_faces();</div><div class="line">    <span class="keywordtype">int</span> NE = tr.number_of_edges();</div><div class="line"></div><div class="line">    <span class="comment">// This function `tr.number_of_dummy_points()` returns the number of dummy points that </span></div><div class="line">    <span class="comment">// are currently in the triangulation. </span></div><div class="line">    <span class="keywordtype">int</span> NDP = tr.number_of_dummy_points();</div><div class="line"></div><div class="line">    <span class="comment">// The result must be identical.</span></div><div class="line">    CGAL_assertion(NDP == DP_remaining);</div><div class="line"></div><div class="line">    cout &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"-------------- STATS --------------"</span> &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Random points generated:           "</span> &lt;&lt; N &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Vertices in the triangulation:     "</span> &lt;&lt; NV &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Dummy points in the triangulation: "</span> &lt;&lt; NDP &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Random points inserted:            "</span> &lt;&lt; N_inserted &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Random points outside/duplicates:  "</span> &lt;&lt; (N - N_inserted) &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"---------- COMBINATORICS ----------"</span> &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Number of vertices NV:             "</span> &lt;&lt; NV &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Number of faces NF:                "</span> &lt;&lt; NF &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Number of edges NE:                "</span> &lt;&lt; NE &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// The number of vertices in the triangulation must equal the number of points</span></div><div class="line">    <span class="comment">// inserted, plus the dummy points in the triangulation.</span></div><div class="line">    CGAL_assertion( N_inserted + NDP == NV );</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Number of vertices is correct!     "</span> &lt;&lt; endl;    </div><div class="line"></div><div class="line">    <span class="comment">// Note that the Euler relation is already verified by the function `is_valid()`.</span></div><div class="line">    CGAL_assertion( (2 + NE - NV - NF) / 2 == 2);</div><div class="line">    cout &lt;&lt; <span class="stringliteral">"Euler relation verified!           "</span> &lt;&lt; endl &lt;&lt; endl;    </div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="P4HT2_Performance"></a>
Performance</h1>
<p>We have measured the insertion execution time of our implementation against other <span style="font-variant: small-caps;">CGAL</span> triangulations. Random points, uniformly distributed in the unit disk with respect to the Euclidean metric, are generated. From these generated points, we select 1 million points that lie in the original octagon \(\mathcal D_O\). We insert the same set of points in three triangulations: </p><ul>
<li>
a periodic hyperbolic Delaunay triangulation with <code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Number_types.tag:../Number_types/" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code> as <code>number type</code>; </li>
<li>
a (non-periodic) Euclidean Delaunay triangulation with <code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Number_types.tag:../Number_types/" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code> as <code>number type</code>; </li>
<li>
a (non-periodic) Euclidean Delaunay triangulation with <code>double</code> as <code>number_type</code>. </li>
</ul>
<p>We report results averaged over 10 executions of this experiment in <a class="el" href="index.html#Table_1">Table 1</a> below. The experiments have been executed on two machines: </p><ul>
<li>
<b>Machine 1:</b> MacBook Pro (2015), CPU: Intel Core i5 @ 2.9 GHz, RAM: 16 GB @ 1867 MHz, OS: Mac OS X (10.10.5), Compiler: clang-700.1.81; </li>
<li>
<b>Machine 2:</b> Dell Vostro 5471 (2018), CPU: Intel Core i5 @ 1.6 GHZ (up to 3.4 GHz in TurboMode), RAM: 8GB @ 2400 MHz, OS: Linux Mint 19 (kernel 4.15.0), Compiler: gcc version 7.3.0. </li>
</ul>
<center> <a class="anchor" id="Table_1"></a><a class="anchor" id=""></a>
<table class="doxtable">
<caption>Table 1: Comparison of insertion times of 1 million random points</caption>
<tr>
<th>Triangulation type </th><th>Machine 1 </th><th>Machine 2 </th></tr>
<tr>
<td>Periodic hyperbolic (<code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Number_types.tag:../Number_types/" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code>) </td><td>55 sec. </td><td>40 sec. </td></tr>
<tr>
<td>Non-periodic Euclidean (<code><a class="elRef" doxygen="/home/iordanov/Documents/Code/builds/cgal-iordan-clean/doc_tags/Number_types.tag:../Number_types/" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code>) </td><td>24 sec. </td><td>20 sec. </td></tr>
<tr>
<td>Non-periodic Euclidean (<code>double</code>) </td><td>1 sec. </td><td>1 sec. </td></tr>
</table>
</center><p>Another experiment shows that, on average, all dummy points are removed from the triangulation with the insertion of fewer than 200 random points uniformly distributed in the unit disk with respect to the Euclidean metric <a class="el" href="citelist.html#CITEREF_cgal:it-idtbs-17">[4]</a>. We start with an empty triangulation of the Bolza surface (i.e., initialized with only the dummy points), and we start inserting random points one by one. After each insertion, the unnecessary dummy points (if any) are removed from the triangulation. As soon as the last dummy point has been removed, we stop the process and record the number of random points inserted. Results are shown in <a class="el" href="index.html#fig__P4HDummyPointsHistogram">Figure 43.7</a>.</p>
<p><a class="anchor" id="fig__P4HDummyPointsHistogram"></a></p><center> <div class="image">
<img src="histogram-dummy-points.png" style="max-width:85%; width=85%; display: inline-block;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P4HDummyPointsHistogram">Figure 43.7</a> Histogram of the number of random input points needed to remove all dummy points in a triangulation of the Bolza surface. The histogram shows results acquired from 1000 executions of the experiment described above. In these 1000 executions, the minimum number of random points needed to remove all dummy points was 23, the maximum 188, and on average 64 random points were needed.  </div>  <br />

<h1><a class="anchor" id="P4HT2_Design"></a>
Design and Implementation History</h1>
<p>This package implements the algorithm for the computation of Delaunay triangulation of the Bolza surface proposed by Mikhail Bogdanov, Monique Teillaud and Gert Vegter <a class="el" href="citelist.html#CITEREF_cgal:btv-dtosl-16">[1]</a>. The implementation itself is described by Iordan Iordanov and Monique Teillaud <a class="el" href="citelist.html#CITEREF_cgal:it-idtbs-17">[4]</a>.</p>
<p>In 2016, Iordanov started working on the 2D Periodic Hyperbolic Triangulations package. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Nov 16 2018 23:16:13 for CGAL 4.14 - 2D Periodic Hyperbolic Triangulations by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>


</html>
